### Личные кабинеты: роли и детальный функционал

- Роли:
  - Путешественник (User)
  - Туроператор/Агент (Operator/Agent)
  - Администратор (Admin)
  - Модератор (Moderator, опционально)
  - Поддержка (Support, опционально)

## ЛК Путешественника

- Профиль
  - Данные: имя, фото, телефон, email, язык, часовой пояс
  - Удостоверение/страховка: загрузка и хранение PDF/JPEG, сроки действия, напоминания
  - Экстренные контакты: список, отметка «Основной», быстрозвонок
  - Предпочтения: типы туров, уровень активности, питание, аллергии

- Бронирования
  - Текущие/предстоящие: даты, оператор, статус, оплата, документы
  - История: завершённые поездки, отзывы, скачивание чеков/договоров
  - Управление: отмена/перенос (по политике), запрос изменений, доп.услуги

- Платежи и документы
  - Способы оплаты: карты (tokenized), реквизиты, сохранение методов
  - Заказы: счета, чеки, договоры, ваучеры (PDF), счета на предоплату
  - Возвраты: статусы, сроки, причины, уведомления

- Поиск/Избранное
  - Сохранённые фильтры и запросы
  - «Отложенные» туры/операторы
  - Нотификации об изменении цены/доступности

- Безопасность (SOS)
  - История SOS: дата/координаты, статус «отправлен/подтверждён/закрыт»
  - Настройки безопасности: авто-отправка координат, вибро/звуки, списки рассылки
  - Экстренные материалы: first-aid, контакты служб

- Коммуникации
  - Чат с оператором/поддержкой: файлы, фото, быстрые шаблоны
  - Уведомления: in-app, email, push (подтверждения, напоминания, изменения)
  - Центр уведомлений: фильтры по типу, «прочитать всё»

- Отзывы и рейтинг
  - Оставить отзыв: шкала + текст + фото/видео
  - История отзывов: статус модерации, правки/удаление по политике

- Настройки и доступ
  - Устройства/сессии: завершение «всех сеансов»
  - Двухфакторная аутентификация (опционально)
  - Экспорт данных (GDPR), удаление аккаунта

## ЛК Туроператора/Агента (Back‑office)

- Дашборд
  - Лиды/заявки: новые/в работе/закрытые, SLA ответа
  - Ближайшие заезды, загрузка групп, отказы/переносы
  - Доходы/выплаты: график, задолженности, возвраты

- Продуктовый каталог
  - Туры: CRUD, копирование, шаблоны
  - Контент: описание, фото/видео/галереи, FAQ, что включено/исключено, уровень сложности
  - SEO: тайтл/дескрипшн/slug, поддержка языков

- Календарь и квоты
  - Даты/слоты: массовые операции, периодичность, количество мест, детские цены
  - Ценообразование: базовая цена, динамическая на даты/раннее бронирование/last‑minute
  - Блокировки и стоп‑продажи

- Заказы и клиенты
  - Список бронирований: статусы, предоплаты/оплаты, доп.услуги
  - Карточка заказа: состав группы, документы, история изменений
  - Договоры и счета: генерация, отправка, подпись (если есть интеграция)

- Лиды и коммуникации
  - Входящие заявки с портала: карточка лида, квалификация, конвертация в заказ
  - Ответы клиенту: чат/email/шаблоны, вложения
  - Интеграции: Telegram/WhatsApp/email‑relay

- Финансы
  - Выплаты: график, акты, комиссии портала
  - Возвраты: причины, статусы, автоматизация части сценариев
  - Реквизиты и налоги: ИНН/КПП/адрес, валюта, документы

- Аналитика
  - Конверсия по страницам туров/лидам/заказам
  - Источники трафика (UTM), эффективность акций
  - Нагрузка по датам, средний чек, margin (если заведены себестоимости)

- Команда и доступы
  - Роли: владелец/менеджер/контент/бухгалтер
  - Логи активности, привязка отдельных туров к ответственным

- Интеграции
  - Импорт календаря: CSV/Google Sheets/API
  - Экспорт на маркетплейсы (опционально)
  - Веб‑виджет «Бронировать» для сайта оператора

## ЛК Администратора

- Управление каталогом
  - Модерация туров/операторов: проверка реквизитов, статусов «Проверен/Партнёр/Официальный»
  - Категории, регионы, теги, фильтры

- Пользователи и роли
  - Путешественники/операторы: блокировки, сброс пароля, смена роли
  - Команды операторов: подтверждение владения

- Контент и SEO
  - Статические страницы, коллекции («операторы по…»), баннеры
  - Локализация, мультиязычность

- Лиды/модерация
  - Антиспам, лимиты, ручная проверка
  - Модерация отзывов и жалоб

- Финансы и отчётность
  - Комиссии, тарифы, акты/выплаты операторам
  - Экспорт в бухгалтерию, сверки

- Техподдержка
  - Управление тикетами, SLA, база знаний
  - Инциденты и рассылки

- Настройки платформы
  - Платёжные провайдеры, email/SMS/push ключи, интеграции
  - Правовые документы, возрастные/страховые требования

## Права и доступы (сокращённо)

- Путешественник: свой профиль/заказы/SOS/Отзывы.
- Оператор: свои туры/календарь/лиды/заказы/выплаты/команда.
- Модератор: контент/отзывы/операторы (чтение/модерация).
- Админ: всё.

## Основные сущности (модель данных, кратко)

- User(id, email, name, phone, preferences, emergencyContacts[], role)
- Operator(id, name, website, contacts, verifiedStatus, partnerLevel, score)
- Tour(id, operatorId, title, region, activity, description, media[], pricing, policies)
- CalendarSlot(id, tourId, dateStart, dateEnd, capacity, priceOverrides)
- Inquiry(id, operatorId, userId?, name, email, message, status, timestamps)
- Booking(id, userId, operatorId, tourId, slotId, price, status, payments[], docs[])
- Review(id, userId, tourId/operatorId, rating, text, media[], status)
- EmergencyReport(id, userId, coordinates, timestamp, status, type, severity)
- Notification(id, userId, type, channel, payload, deliveredAt)
- Payout(id, operatorId, amount, status, period)

## Ключевые пользовательские потоки

- Лид → коммуникация → заказ → оплата → документы → поездка → отзыв.
- Создание тура → календарь → публикация → лиды → конверсия → выплата.
- SOS → отправка координат → подтверждение → закрытие/отчёт.
- Модерация: оператор/тур/отзыв → статусы → публикация/отклонение.

## Уведомления и SLA

- Каналы: in‑app, email, push, (опц.) SMS.
- Триггеры: новый лид, ответ, подтверждение оплаты, напоминание о дате, изменения, 24/72ч до старта, SOS события.
- SLA: отклик оператора ≤ 1 рабочий день; эскалация админам.

## Безопасность и приватность

- JWT/Refresh, 2FA (опц.), ограничение сессий.
- Шифрование хранимых персональных доков.
- Роли/ACL, аудит действий.
- Удаление/экспорт данных (GDPR‑подобные требования).

## Веб/Мобайл особенности

- Веб: SEO‑страницы туров/операторов, лендинги.
- Мобайл: офлайн‑кеш, доступ к геолокации, SOS.
- Доступность: контраст, размер шрифта, навигация.

## Метрики и аналитика

- Конверсии: просмотр → лид → заказ → оплата → отзыв.
- Скорость ответа операторов, доля подтверждений, возвраты.
- NPS/CSAT, рейтинг операторов, топ‑фильтры/поисковые запросы.

## Интеграции и импорты

- Календарь: CSV/Google Sheets/API.
- Платежи: провайдер по рынку (эквайринг/СПБ).
- Мессенджеры: Telegram/WhatsApp (через провайдеров).
- Хранилище медиа: CDN/S3.

## План внедрения (по этапам)

- Этап 1 (MVP, 2–3 недели)
  - ЛК Путешественника: профиль, бронирования, заявки, избранное.
  - ЛК Оператора: туры, календарь, лиды, базовые заказы.
  - Админ: модерация операторов/туров, статусы, простая аналитика.
  - Уведомления email + in‑app, базовая безопасность.

- Этап 2
  - Платежи, документы, возвраты; отзывы и модерация.
  - Расширенный поиск, сохранённые фильтры, SEO‑лендинги.
  - Импорт календарей, интеграции мессенджеров, виджет «Бронировать».

- Этап 3
  - Продвинутая аналитика и партнёрские отчёты.
  - Push‑уведомления, офлайн режим, карты/маршруты.
  - Партнёрская программа, реферальные ссылки, баннеры.

## Критерии готовности (Definition of Done)

- Для каждого ЛК: завершённые разделы с тестами, правами доступа и UX‑сценариями.
- Отсутствуют блокирующие баги, соблюдена безопасность и приватность.
- Документация API/сущностей/ролей, инструкции для операторов и админов.
- Настроены мониторинг и алерты.


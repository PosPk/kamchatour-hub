<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root{--bg:#0b1020;--text:#e5e7eb;--muted:#94a3b8;--card:#0f172a;--primary:#0891b2}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;background:var(--bg);color:var(--text)}
    .wrap{padding:16px 16px 96px}
    .btn{display:inline-block;background:rgba(255,255,255,.08);color:var(--text);text-decoration:none;padding:8px 12px;border-radius:10px;border:1px solid rgba(148,163,184,.25)}
    .card{background:var(--card);border:1px solid rgba(148,163,184,.25);border-radius:12px;padding:14px;margin-bottom:14px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .role{display:flex;gap:10px;align-items:center;padding:12px;border-radius:12px;border:1px solid rgba(148,163,184,.25);background:rgba(255,255,255,.04);cursor:pointer}
    .role.active{outline:2px solid var(--primary)}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top"><a class="btn" href="/tg">‚Üê –ù–∞–∑–∞–¥</a><h1 style="margin:0;display:inline-block;margin-left:8px">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1></div>
    <div id="user" class="card">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è‚Ä¶</div>
    <div class="card">
      <div class="muted" style="margin-bottom:8px">–†–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ</div>
      <div class="grid" id="roles"></div>
    </div>
  </div>
  <script>
    function roleTile(key,title,emoji,current){ const d=document.createElement('div'); d.className='role'+(current===key?' active':''); d.innerHTML=`<div style="font-size:20px">${emoji}</div><div><div style="font-weight:600">${title}</div><div class="muted" style="font-size:12px">–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div></div>`; d.addEventListener('click',async()=>{ await fetch('/api/tg/role',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({role:key})}); loadMe(); }); return d; }
    async function loadMe(){ try{ const r=await fetch('/api/tg/me'); const j=await r.json(); const role=j?.user?.role||'traveler'; document.getElementById('user').innerHTML = `<div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ¬∑ —Ä–æ–ª—å: ${role}</div>`; const box=document.getElementById('roles'); box.innerHTML=''; [['operator','–¢—É—Ä–æ–ø–µ—Ä–∞—Ç–æ—Ä','üèîÔ∏è'],['traveler','–ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫','üß≠'],['rental','–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä','üèïÔ∏è'],['transfer','–¢—Ä–∞–Ω—Å—Ñ–µ—Ä','üöê'],['agent','–ê–≥–µ–Ω—Ç','ü§ù']].forEach(([k,t,e])=>box.appendChild(roleTile(k,t,e,role))); }catch(_){ }
    }
    (function(){ try{ var tg=window.Telegram&&window.Telegram.WebApp; if(tg){ tg.ready(); tg.expand(); } }catch(_){ } loadMe(); })();
  </script>
</body>
</html>


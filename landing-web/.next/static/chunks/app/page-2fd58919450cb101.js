(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1109:function(e,t,n){Promise.resolve().then(n.t.bind(n,2972,23)),Promise.resolve().then(n.bind(n,1523)),Promise.resolve().then(n.bind(n,49)),Promise.resolve().then(n.bind(n,3644)),Promise.resolve().then(n.bind(n,1336))},1523:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return o}});let r=n(8993);function o(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return i}});let r=n(7437),o=n(544);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,o.getExpectedRequestStore)("next/dynamic css"),i=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));i.push(...t)}}return 0===i.length?null:(0,r.jsx)(r.Fragment,{children:i.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},3644:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(7437),o=n(2265);function i(){let e=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let t;return(async()=>{let r=await n.e(212).then(n.t.bind(n,759,23));if(await Promise.all([n.e(641),n.e(46)]).then(n.t.bind(n,5046,23)),!e.current)return;t=r.map(e.current,{zoomControl:!1}).setView([53.9,159.6],5),r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(t);let o=await fetch("/data/bears.geojson"),i=await o.json(),l=e=>r.divIcon({html:'<div style="background:'.concat("high"===e?"#FF3B30":"medium"===e?"#FF9500":"#34C759",';width:12px;height:12px;border-radius:50%;border:2px solid rgba(255,255,255,0.9)"></div>'),className:"",iconSize:[12,12]});r.geoJSON(i,{pointToLayer:(e,t)=>{var n;return r.marker(t,{icon:l((null===(n=e.properties)||void 0===n?void 0:n.severity)||"low")})},onEachFeature:(e,t)=>{let n=e.properties||{};t.bindPopup("<b>".concat(n.title||"Наблюдение","</b><br/>Статус: ").concat(n.severity||"-","<br/>Дата: ").concat(n.date||"-"))}}).addTo(t)})(),()=>{try{null==t||t.remove()}catch(e){}}},[]),(0,r.jsx)("div",{ref:e,className:"w-full h-72 rounded-2xl overflow-hidden border border-white/10"})}},1336:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(7437),o=n(2265);function i(){let[e,t]=(0,o.useState)(!1),[n,i]=(0,o.useState)("Привет! Подскажи популярные туры и безопасность."),[l,s]=(0,o.useState)([{role:"assistant",content:"Я KAMAI — ИИ‑администратор. Чем помочь?"}]),a=(0,o.useRef)(null);(0,o.useEffect)(()=>{var e;null===(e=a.current)||void 0===e||e.scrollTo({top:999999,behavior:"smooth"})},[l,e]);let d=async()=>{if(!n.trim())return;let e=[...l,{role:"user",content:n}];s(e),i("");try{let t=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:e})}),n=await t.json();s([...e,{role:"assistant",content:(null==n?void 0:n.content)||"Ок."}])}catch(t){s([...e,{role:"assistant",content:"Ошибка сети, попробуйте позже."}])}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>t(!e),className:"fixed z-50 bottom-5 right-5 h-12 px-4 rounded-full bg-premium-gold text-premium-black font-bold shadow-lg",children:e?"Закрыть KAMAI":"KAMAI • помощь"}),e&&(0,r.jsxs)("div",{className:"fixed z-50 bottom-20 right-5 w-[min(92vw,360px)] rounded-2xl bg-black/80 backdrop-blur border border-white/10 overflow-hidden",children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-white/10 font-bold",children:"KAMAI — ИИ‑администратор"}),(0,r.jsx)("div",{ref:a,className:"h-64 overflow-y-auto px-4 py-3 space-y-3",children:l.map((e,t)=>(0,r.jsx)("div",{className:"assistant"===e.role?"text-white/90":"text-premium-gold",children:e.content},t))}),(0,r.jsxs)("div",{className:"p-3 flex gap-2",children:[(0,r.jsx)("input",{value:n,onChange:e=>i(e.target.value),placeholder:"Спросите у KAMAI…",className:"flex-1 h-10 rounded-xl px-3 text-slate-900"}),(0,r.jsx)("button",{onClick:d,className:"h-10 px-4 rounded-xl bg-premium-gold text-premium-black font-bold",children:"Отправить"})]})]})]})}}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=1109)}),_N_E=e.O()}]);